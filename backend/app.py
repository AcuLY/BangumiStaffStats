from quart import Quart, jsonify, request
from quart_cors import cors
from api import generate_ranked_lists
import asyncio

app = Quart(__name__)

app = cors(app, allow_origin="*")

@app.post('/statistics')
async def get_statistics():
    # return jsonify({'valid_subjects': [{'person_name': '石原立也', 'number': 9, 'subject_ids': [283643, 386195, 216372, 152091, 115908, 37874, 37873, 51, 876], 'subject_names': ['響け！ユーフォニアム３', '特別編 響け！ユーフォニアム～アンサン ブルコンテスト～', '劇場版 響け！ユーフォニアム～誓いの フィナーレ～', '響け！ユーフォニアム2', '響け！ユーフォ ニアム', 'CLANNAD 〜AFTER STORY〜もうひとつの世界 杏編', 'CLANNAD もうひとつの世界 智代編', 'CLANNAD -クラナド-', 'CLANNAD 〜AFTER STORY〜'], 'rates': [6, 8, 7, 9, 8, 0, 0, 8, 10], 'average_rate': 8.0}, {'person_name': '及川啓', 'number': 8, 'subject_ids': [407332, 354414, 212003, 315574, 277954, 102134, 325587, 142678], 'subject_names': ['ウマ娘 プリティーダービー Season 3', 'SHINE POST', 'ウマ娘 プリティーダービー', 'ウマ娘 プリティーダービー Season 2', 'やはり俺の青春ラブコメはまちがっている。完', 'やはり俺の青春ラブコメはまちがっている。続', 'やはり 俺の青春ラブコメはまちがっている。完 OVA', 'やはり俺の青春ラブコメはまちがっている。続 OVA'], 'rates': [6, 7, 7, 9, 0, 0, 0, 0], 'average_rate': 7.25}, {'person_name': '岸誠二', 'number': 7, 'subject_ids': [253650, 236020, 26449, 109328, 311759, 1851, 214272], 'subject_names': ['あそびあそばせ OAD', 'あそびあそばせ', '人類は衰退しました', '結城友奈は勇者である', '結城友奈は勇者である -大満開の章-', 'Angel Beats!', 'ようこそ実力至上主義の教室へ'], 'rates': [7, 8, 7, 6, 6, 7, 5], 'average_rate': 6.57}, {'person_name': '京極尚彦', 'number': 6, 'subject_ids': [214799, 354146, 75989, 49294, 306742, 107199], 'subject_names': ['宝石の国', 'ラブライブ！スーパースター!! 2 期', 'ラブライブ! 第2期', 'ラブライブ!', 'ラブライブ！スーパースター!!', 'ラブライブ! The School Idol Movie'], 'rates': [8, 4, 7, 7, 6, 7], 'average_rate': 6.5}, {'person_name': '柿本広大', 'number': 5, 'subject_ids': [464561, 246430, 246429, 428735, 215158], 'subject_names': [' 菜なれ花なれ', 'BanG Dream! 3rd Season', 'BanG Dream! 2nd Season', "BanG Dream! It's MyGO!!!!!", '刀使ノ巫女'], 'rates': [4, 8, 8, 8, 6], 'average_rate': 6.8}, {'person_name': 'Justin Roiland', 'number': 5, 'subject_ids': [331936, 246238, 146457, 141530, 93377], 'subject_names': ['Rick and Morty Season 5', 'Rick and Morty Season 4', 'Rick and Morty Season 3', 'Rick and Morty Season 2', 'Rick and Morty Season 1'], 'rates': [8, 9, 8, 8, 9], 'average_rate': 8.4}, {'person_name': '元永慶太郎', 'number': 5, 'subject_ids': [391866, 106060, 76325, 228254, 49131], 'subject_names': ['HIGHSPEED Étoile', '劇場版 デート ・ア・ライブ 万由里ジャッジメント', 'デート・ア・ライブII', 'デート・ア・ライブⅢ', 'デート・ア・ライブ'], 'rates': [6, 5, 0, 0, 0], 'average_rate': 5.5}, {'person_name': '宮本幸裕', 'number': 5, 'subject_ids': [427233, 339998, 44693, 159690, 302875], 'subject_names': ['五等分の花嫁∽', 'マギアレコード 魔法少女まどか☆マギカ外伝 Final SEASON ‐浅き夢の暁‐', '劇場版 魔法少女まどか☆マギカ [新編] 叛逆の物語', 'マギアレコード 魔法少女まどか☆マギカ外伝', 'マギアレコード 魔法少女まどか☆マギカ外伝 2nd SEASON -覚醒前夜-'], 'rates': [8, 4, 9, 0, 0], 'average_rate': 7.0}, {'person_name': '小俣真一', 'number': 5, 'subject_ids': [425591, 425211, 317613, 248175, 293049], 'subject_names': ['アンデッドガール・マーダーファルス', 'かぐや様は告らせたい-ファーストキッスは終わらない-', 'かぐや様は告らせたい-ウルトラロマンティック-', 'かぐや様は告らせたい～天才たちの恋愛頭脳戦～', 'かぐや様は告らせたい？～天才たちの恋愛頭脳戦～'], 'rates': [7, 8, 9, 8, 7], 'average_rate': 7.8}, {'person_name': '山田尚子', 'number': 5, 'subject_ids': [117777, 12426, 216371, 1424, 3774], 'subject_names': ['聲の形', '映画けいおん！', 'リズと青い鳥', 'けいおん！', 'けいおん！！'], 'rates': [6, 8, 9, 8, 8], 'average_rate': 7.8}, {'person_name': '伊藤智彦', 'number': 5, 'subject_ids': [269090, 137722, 148099, 92382, 23686], 'subject_names': ['HELLO WORLD', '僕だけがいない街', '劇場版 ソードアート・オンライン -オーディナル・ スケール-', 'ソードアート・オンラインII', 'ソードアート ・オンライン'], 'rates': [5, 6, 6, 7, 7], 'average_rate': 6.2}, {'person_name': '宮嶋星矢', 'number': 4, 'subject_ids': [296295, 246431, 380506, 269389], 'subject_names': ['BanG Dream! ガルパ☆ピコ～大盛り～', 'BanG Dream! ガルパ☆ピコ', 'うまゆる', 'うまよん'], 'rates': [7, 7, 0, 6], 'average_rate': 6.66}, {'person_name': '夏目真悟', 'number': 4, 'subject_ids': [100501, 80864, 345980, 332649], 'subject_names': ['スペース☆ダンディ シーズン2', 'スペース☆ダンディ', '四畳半タイムマシンブルース', 'Sonny Boy -サニーボーイ-'], 'rates': [9, 8, 8, 7], 'average_rate': 8.0}, {'person_name': '林祐一郎', 'number': 4, 'subject_ids': [415779, 376739, 331752, 285666], 'subject_names': ['進撃の巨人 The Final Season 完結編 後編', '進撃の巨人 The Final Season 完結編 前編', '進撃の巨人 The Final Season Part.2', '進撃の巨人 The Final Season'], 'rates': [7, 8, 8, 0], 'average_rate': 7.66}, {'person_name': '湯浅政明', 'number': 4, 'subject_ids': [282433, 93739, 202240, 4019], 'subject_names': ['映像研には手を出すな！', 'ピンポン THE ANIMATION', '夜は短し歩けよ乙女', '四畳半神話大系'], 'rates': [9, 9, 7, 8], 'average_rate': 8.25}, {'person_name': '山本裕介', 'number': 4, 'subject_ids': [290980, 216310, 86670, 41658], 'subject_names': [' ヤマノススメ Next Summit', 'ヤマノススメ サードシーズン', 'ヤマノススメ セカンドシーズン', 'ヤマノススメ'], 'rates': [7, 7, 6, 6], 'average_rate': 6.5}, {'person_name': '武本康弘', 'number': 4, 'subject_ids': [13557, 276, 3375, 1606], 'subject_names': ['らき☆すた OVA', 'らき☆すた', '涼宮ハルヒの消失', '涼宮ハルヒの憂鬱'], 'rates': [0, 8, 8, 7], 'average_rate': 7.66}, {'person_name': 'いし づかあつこ', 'number': 4, 'subject_ids': [218708, 187276, 79227, 41488], 'subject_names': ['宇宙よりも遠い場所', 'ノーゲーム・ノーライフ ゼロ', 'ノーゲーム・ノーライフ', 'さくら荘のペットな彼女'], 'rates': [9, 7, 7, 7], 'average_rate': 7.5}, {'person_name': '幾原邦彦', 'number': 4, 'subject_ids': [1891, 1453, 59825, 18624], 'subject_names': ['少女革命ウテナ アドゥレセンス黙示録', '少女革命ウテナ', 'ユリ熊嵐', '輪るピングドラム'], 'rates': [0, 0, 7, 8], 'average_rate': 7.5}, {'person_name': '肥塚正史', 'number': 4, 'subject_ids': [221781, 263750, 217300, 118335], 'subject_names': ['進撃の巨人 LOST GIRLS', '進 撃の巨人 Season 3 Part.2', '進撃の巨人 Season 3', '進撃 の巨人 Season 2'], 'rates': [0, 0, 0, 8], 'average_rate': 8.0}, {'person_name': '何小疯', 'number': 4, 'subject_ids': [329160, 312700, 277436, 244008], 'subject_names': ['伍六七之玄武国篇 下篇', '伍六七之玄武国篇 上篇', '伍 六七之最强发型师', '刺客伍六七'], 'rates': [5, 6, 6, 6], 'average_rate': 5.75}, {'person_name': 'Dan Harmon', 'number': 3, 'subject_ids': [146457, 141530, 93377], 'subject_names': ['Rick and Morty Season 3', 'Rick and Morty Season 2', 'Rick and Morty Season 1'], 'rates': [8, 8, 9], 'average_rate': 8.33}, {'person_name': '新海誠', 'number': 3, 'subject_ids': [160209, 269235, 58949], 'subject_names': ['君の名は。', '天気の子', '言の葉の庭'], 'rates': [8, 7, 0], 'average_rate': 7.5}, {'person_name': ' 水島努', 'number': 3, 'subject_ids': [404809, 244761, 110467], 'subject_names': ['終末トレインどこへいく？', '劇場版 SHIROBAKO', 'SHIROBAKO'], 'rates': [7, 8, 9], 'average_rate': 8.0}, {'person_name': '今石洋之', 'number': 3, 'subject_ids': [8402, 72941, 309311], 'subject_names': ['Panty & Stocking with Garterbelt', 'キルラキル', 'Cyberpunk: Edgerunners'], 'rates': [8, 8, 9], 'average_rate': 8.33}, {'person_name': '古橋一浩', 'number': 3, 'subject_ids': [411427, 373267, 329906], 'subject_names': ['SPY×FAMILY Season 2', 'SPY×FAMILY 第2クール', 'SPY×FAMILY'], 'rates': [7, 7, 7], 'average_rate': 7.0}, {'person_name': '松下周平', 'number': 3, 'subject_ids': [424372, 363101, 331479], 'subject_names': ['Dr.STONE NEW WORLD 第2クール', 'Dr.STONE NEW WORLD', 'Dr.STONE 龍水'], 'rates': [7, 7, 8], 'average_rate': 7.33}, {'person_name': '古川知宏', 'number': 3, 'subject_ids': [294134, 294135, 214265], 'subject_names': ['少女☆歌劇 レヴュースタァライト ロンド・ロンド・ロンド', '劇場版 少女☆歌劇 レヴュースタァライト', '少女☆歌劇 レヴュースタァライト'], 'rates': [8, 10, 8], 'average_rate': 8.66}, {'person_name': '河村 智之', 'number': 3, 'subject_ids': [408883, 335579, 296659], 'subject_names': ['ラブライブ！虹ヶ咲学園スクールアイドル同好会 NEXT SKY', 'ラブライブ！虹ヶ咲学園スクール アイドル同好会 2期', 'ラブライブ！虹ヶ咲学園スクールアイドル同好会'], 'rates': [7, 8, 7], 'average_rate': 7.33}, {'person_name': '小林寛', 'number': 3, 'subject_ids': [403238, 349441, 391706], 'subject_names': ['機動戦士ガンダム 水星の魔女 Season2', '機動戦士ガンダム 水星の魔女', '機動戦士ガンダム 水星の魔女 PROLOGUE'], 'rates': [5, 7, 0], 'average_rate': 6.0}, {'person_name': '増井壮一', 'number': 3, 'subject_ids': [389450, 260680, 240038], 'subject_names': ['アキバ冥途戦争', '青春ブタ野郎はゆめみ る少女の夢を見ない', '青春ブタ野郎はバニーガール先輩の夢を見ない'], 'rates': [0, 0, 7], 'average_rate': 7.0}, {'person_name': '小島正幸', 'number': 3, 'subject_ids': [298477, 230914, 203526], 'subject_names': ['メイドインア ビス 烈日の黄金郷', '劇場版 メイドインアビス 深き魂の黎 明', 'メイドインアビス'], 'rates': [8, 8, 9], 'average_rate': 8.33}, {'person_name': '荒木哲郎', 'number': 3, 'subject_ids': [55770, 110049, 1773], 'subject_names': [' 進撃の巨人', '進撃の巨人 悔いなき選択 OAD', 'DEATH NOTE'], 'rates': [8, 0, 8], 'average_rate': 8.0}, {'person_name': '今千秋', 'number': 3, 'subject_ids': [288, 289, 2782], 'subject_names': ['ひぐらしのなく頃に解', 'ひぐらしのなく頃に', 'NARUTO -ナルト- 疾風伝'], 'rates': [8, 7, 0], 'average_rate': 7.5}, {'person_name': '本間修', 'number': 2, 'subject_ids': [477207, 356756], 'subject_names': ['真夜中ぱんチ', 'パリピ孔明'], 'rates': [8, 7], 'average_rate': 7.5}, {'person_name': '太田雅彦', 'number': 2, 'subject_ids': [484761, 14588], 'subject_names': ['しかのこのこのここしたんたん', 'ゆるゆり'], 'rates': [5, 6], 'average_rate': 5.5}, {'person_name': '桑原智', 'number': 2, 'subject_ids': [282372, 256114], 'subject_names': ['安達としまむら', '五等分の花嫁'], 'rates': [6, 0], 'average_rate': 6.0}, {'person_name': '酒井和男', 'number': 2, 'subject_ids': [431767, 165553], 'subject_names': ['ガールズバンドクライ', 'ラブライブ! サンシャイン!!'], 'rates': [8, 6], 'average_rate': 7.0}, {'person_name': 'ほりうちゆうや', 'number': 2, 'subject_ids': [471926, 401960], 'subject_names': ['にじよん あにめーしょん 2', ' にじよん あにめーしょん'], 'rates': [7, 7], 'average_rate': 7.0}, {'person_name': '窪岡俊之', 'number': 2, 'subject_ids': [390980, 292970], 'subject_names': ['シャング リラ・フロンティア～クソゲーハンター、神ゲーに挑まんとす～', '魔女の旅々'], 'rates': [6, 7], 'average_rate': 6.5}, {'person_name': '大槻敦史', 'number': 2, 'subject_ids': [424663, 186515], 'subject_names': ['魔法少女にあこがれて', 'BanG Dream!'], 'rates': [7, 7], 'average_rate': 7.0}, {'person_name': '斎藤圭一郎', 'number': 2, 'subject_ids': [400602, 328609], 'subject_names': ['葬送のフリ ーレン', 'ぼっち・ざ・ろっく！'], 'rates': [9, 8], 'average_rate': 8.5}, {'person_name': '若林信', 'number': 2, 'subject_ids': [331935, 316607], 'subject_names': ['ワンダーエッグ・プライオリティ 特別編', 'ワンダーエッグ・プ ライオリティ'], 'rates': [4, 7], 'average_rate': 5.5}, {'person_name': 'かおり', 'number': 2, 'subject_ids': [404115, 282000], 'subject_names': ['星屑テレパス', '五等分の花嫁∬'], 'rates': [5, 7], 'average_rate': 6.0}, {'person_name': '中西和也', 'number': 2, 'subject_ids': [419846, 329114], 'subject_names': ['陰の実力者になりたくて！ 2nd season', '陰の実力者になりたくて！'], 'rates': [7, 7], 'average_rate': 7.0}, {'person_name': '渡邉祐記', 'number': 2, 'subject_ids': [411268, 354190], 'subject_names': ['アークナイツ【冬隠帰路/PERISH IN FROST】', 'アークナイツ【黎明前奏/PRELUDE TO DAWN】'], 'rates': [6, 5], 'average_rate': 5.5}, {'person_name': '佐藤卓哉', 'number': 2, 'subject_ids': [223818, 10380], 'subject_names': ['あさがおと加瀬さん。', 'STEINS;GATE'], 'rates': [7, 9], 'average_rate': 8.0}, {'person_name': '今敏', 'number': 2, 'subject_ids': [841, 839], 'subject_names': ['パプリカ', 'PERFECT BLUE'], 'rates': [8, 8], 'average_rate': 8.0}, {'person_name': '稲垣隆行', 'number': 2, 'subject_ids': [389998, 354682], 'subject_names': ['BIRDIE WING -Golf Girls’ Story- Season 2', 'BIRDIE WING -Golf Girls’ Story-'], 'rates': [7, 7], 'average_rate': 7.0}, {'person_name': '神保昌登', 'number': 2, 'subject_ids': [266070, 331489], 'subject_names': ['へやキャン△', '映画 五等分 の花嫁'], 'rates': [8, 8], 'average_rate': 8.0}, {'person_name': '長山延好', 'number': 2, 'subject_ids': [375735, 292832], 'subject_names': ['恋愛フロップス', 'うらみちお兄さん'], 'rates': [7, 7], 'average_rate': 7.0}, {'person_name': '渡部穏寛', 'number': 2, 'subject_ids': [364845, 2782], 'subject_names': ['てっぺんっ!!!!!!!!!!!!!!!', 'NARUTO -ナルト- 疾風伝'], 'rates': [7, 0], 'average_rate': 7.0}, {'person_name': '福岡大生', 'number': 2, 'subject_ids': [359985, 195937], 'subject_names': ['神クズ☆アイドル', '結城友奈は勇者である -鷲尾須美の章-/-勇者の 章-'], 'rates': [7, 7], 'average_rate': 7.0}, {'person_name': '渡邊政治', 'number': 2, 'subject_ids': [276412, 28496], 'subject_names': ['グランベルム', 'NARUTO-ナルト- SD ロック・リーの青春フルパワー忍伝'], 'rates': [5, 6], 'average_rate': 5.5}, {'person_name': '桜井弘明', 'number': 2, 'subject_ids': [313852, 272510], 'subject_names': ['まちカドまぞく 2丁目', 'まちカドまぞく'], 'rates': [7, 7], 'average_rate': 7.0}, {'person_name': '金﨑貴臣', 'number': 2, 'subject_ids': [135275, 274646], 'subject_names': ['この素晴らしい世界に祝福を！', 'プリンセスコネクト！Re:Dive'], 'rates': [6, 5], 'average_rate': 5.5}, {'person_name': '石井俊匡', 'number': 2, 'subject_ids': [331887, 302189], 'subject_names': ['86―エイティシックス― 第2クール', '86―エイティシックス―'], 'rates': [8, 6], 'average_rate': 7.0}, {'person_name': '京極義昭', 'number': 2, 'subject_ids': [262897, 207195], 'subject_names': ['ゆるキャン△ SEASON 2', 'ゆるキャン△'], 'rates': [8, 8], 'average_rate': 8.0}, {'person_name': '境宗久', 'number': 2, 'subject_ids': [287488, 252655], 'subject_names': ['ゾンビランドサガ リベンジ', 'ゾンビランドサガ'], 'rates': [7, 7], 'average_rate': 7.0}, {'person_name': '長 井龍雪', 'number': 2, 'subject_ids': [909, 10440], 'subject_names': ['とらドラ！', 'あの日見た花の名前を僕達はまだ知らない。'], 'rates': [7, 7], 'average_rate': 7.0}, {'person_name': '亀井幹太', 'number': 2, 'subject_ids': [100403, 132734], 'subject_names': ['冴えない彼女の育てかた', '冴えない彼女の育てかた ♭'], 'rates': [7, 7], 'average_rate': 7.0}, {'person_name': '飯野慎也', 'number': 2, 'subject_ids': [296261, 266794], 'subject_names': ['Dr.STONE STONE WARS', 'Dr.STONE'], 'rates': [6, 7], 'average_rate': 6.5}, {'person_name': '中川淳', 'number': 2, 'subject_ids': [310178, 291171], 'subject_names': ['デー ト・ア・バレット ナイトメア・オア・クイーン', 'デート・ ア・バレット デッド・オア・バレット'], 'rates': [0, 0], 'average_rate': 0}, {'person_name': '浅井義之', 'number': 2, 'subject_ids': [306429, 120925], 'subject_names': ['神様になった日', 'Charlotte'], 'rates': [3, 6], 'average_rate': 4.5}, {'person_name': '吉村愛', 'number': 2, 'subject_ids': [54433, 82777], 'subject_names': ['やはり俺の青春ラブコメはまちがっている。', 'やはり俺の青春ラブコメはまちがっている。 OVA'], 'rates': [0, 0], 'average_rate': 0}, {'person_name': '川村賢一', 'number': 2, 'subject_ids': [129807, 115660], 'subject_names': ['シュタインズ・ゲート ゼロ', 'STEINS;GATE 聡明叡智のコグニティブ・ コンピューティング'], 'rates': [8, 0], 'average_rate': 8.0}, {'person_name': '伊達勇登', 'number': 2, 'subject_ids': [3425, 2782], 'subject_names': ['NARUTO -ナルト-', 'NARUTO -ナルト- 疾風伝'], 'rates': [0, 0], 'average_rate': 0}, {'person_name': 'むらた雅彦', 'number': 2, 'subject_ids': [2782, 28496], 'subject_names': ['NARUTO -ナルト- 疾風伝', 'NARUTO-ナルト- SD ロック・リーの青春フルパワー忍伝'], 'rates': [0, 6], 'average_rate': 6.0}, {'person_name': '倪佳菲', 'number': 1, 'subject_ids': [346429], 'subject_names': ['白色闪电'], 'rates': [7], 'average_rate': 7.0}, {'person_name': 'モリ・マサ', 'number': 1, 'subject_ids': [490824], 'subject_names': ['エグミレガ シー'], 'rates': [7], 'average_rate': 7.0}, {'person_name': '朝岡卓矢', 'number': 1, 'subject_ids': [416320], 'subject_names': ['VTuberなんだが配信切り忘れたら伝説にな ってた'], 'rates': [5], 'average_rate': 5.0}, {'person_name': '梅津朋美', 'number': 1, 'subject_ids': [279219], 'subject_names': ['BanG Dream! FILM LIVE'], 'rates': [8], 'average_rate': 8.0}, {'person_name': 'さとうけいいち', 'number': 1, 'subject_ids': [407234], 'subject_names': ['戦隊大失格'], 'rates': [6], 'average_rate': 6.0}, {'person_name': '菱田正和', 'number': 1, 'subject_ids': [479921], 'subject_names': ['喧嘩独学'], 'rates': [6], 'average_rate': 6.0}, {'person_name': '橘秀樹', 'number': 1, 'subject_ids': [411974], 'subject_names': ['声優ラジオ のウラオモテ'], 'rates': [7], 'average_rate': 7.0}, {'person_name': '石山タカ明', 'number': 1, 'subject_ids': [425978], 'subject_names': ['リンカイ！'], 'rates': [5], 'average_rate': 5.0}, {'person_name': '竹下良平', 'number': 1, 'subject_ids': [425909], 'subject_names': ['夜のクラゲは泳げない'], 'rates': [6], 'average_rate': 6.0}, {'person_name': '登坂晋', 'number': 1, 'subject_ids': [405785], 'subject_names': ['ゆるキャン△ SEASON３'], 'rates': [7], 'average_rate': 7.0}, {'person_name': '宮島善博', 'number': 1, 'subject_ids': [395378], 'subject_names': ['ダンジョン飯'], 'rates': [8], 'average_rate': 8.0}, {'person_name': '野村和也', 'number': 1, 'subject_ids': [248154], 'subject_names': ['風が強く吹いている'], 'rates': [8], 'average_rate': 8.0}, {'person_name': '片桐崇', 'number': 1, 'subject_ids': [411428], 'subject_names': ['劇場版 SPY×FAMILY CODE: White'], 'rates': [7], 'average_rate': 7.0}, {'person_name': '堀元宣', 'number': 1, 'subject_ids': [425595], 'subject_names': ['メタリックルージュ'], 'rates': [4], 'average_rate': 4.0}, {'person_name': '宮崎駿', 'number': 1, 'subject_ids': [228715], 'subject_names': ['君たちはどう生きるか'], 'rates': [8], 'average_rate': 8.0}, {'person_name': '鈴木理人', 'number': 1, 'subject_ids': [424663], 'subject_names': ['魔法少女にあこがれて'], 'rates': [7], 'average_rate': 7.0}, {'person_name': '金森陽子', 'number': 1, 'subject_ids': [443112], 'subject_names': ['姫様“拷問”の時間です'], 'rates': [7], 'average_rate': 7.0}, {'person_name': '長沼範裕', 'number': 1, 'subject_ids': [420628], 'subject_names': ['薬屋のひとりごと'], 'rates': [7], 'average_rate': 7.0}, {'person_name': '八瀬祐樹', 'number': 1, 'subject_ids': [397808], 'subject_names': ['アンデッドアンラック'], 'rates': [6], 'average_rate': 6.0}, {'person_name': '鶴巻和哉', 'number': 1, 'subject_ids': [768], 'subject_names': ['トップをねらえ2!'], 'rates': [8], 'average_rate': 8.0}, {'person_name': '南川達馬', 'number': 1, 'subject_ids': [414214], 'subject_names': ['ひきこまり吸血姫の悶々'], 'rates': [5], 'average_rate': 5.0}, {'person_name': ' 佐久間貴史', 'number': 1, 'subject_ids': [413741], 'subject_names': ['16bitセンセーション ANOTHER LAYER'], 'rates': [5], 'average_rate': 5.0}, {'person_name': '川越一生', 'number': 1, 'subject_ids': [414461], 'subject_names': ['ゾン100～ゾンビになるまでにしたい100のこと～'], 'rates': [4], 'average_rate': 4.0}, {'person_name': '原田孝 宏', 'number': 1, 'subject_ids': [411427], 'subject_names': ['SPY×FAMILY Season 2'], 'rates': [7], 'average_rate': 7.0}, {'person_name': '芦名みのる', 'number': 1, 'subject_ids': [457995], 'subject_names': ['かげじつ！せかんど'], 'rates': [0], 'average_rate': 0}, {'person_name': '安藤正臣', 'number': 1, 'subject_ids': [403722], 'subject_names': ['SHY'], 'rates': [5], 'average_rate': 5.0}, {'person_name': '大庭秀昭', 'number': 1, 'subject_ids': [410928], 'subject_names': ['私の推しは悪役令嬢。'], 'rates': [7], 'average_rate': 7.0}, {'person_name': 'さんぺい聖', 'number': 1, 'subject_ids': [381666], 'subject_names': ['私の百合はお仕事です！'], 'rates': [6], 'average_rate': 6.0}, {'person_name': '庵野秀明', 'number': 1, 'subject_ids': [769], 'subject_names': ['トップをねらえ!'], 'rates': [9], 'average_rate': 9.0}, {'person_name': '塩谷直義', 'number': 1, 'subject_ids': [37685], 'subject_names': ['PSYCHO-PASS サイコパス'], 'rates': [7], 'average_rate': 7.0}, {'person_name': '磯光雄', 'number': 1, 'subject_ids': [794], 'subject_names': ['電脳コイル'], 'rates': [7], 'average_rate': 7.0}, {'person_name': '平牧大輔', 'number': 1, 'subject_ids': [386809], 'subject_names': ['【推しの子】'], 'rates': [7], 'average_rate': 7.0}, {'person_name': '木野目優', 'number': 1, 'subject_ids': [409088], 'subject_names': ['ワールドダイスター'], 'rates': [6], 'average_rate': 6.0}, {'person_name': '森大貴', 'number': 1, 'subject_ids': [404804], 'subject_names': ['天国大魔境'], 'rates': [8], 'average_rate': 8.0}, {'person_name': '廖程芝', 'number': 1, 'subject_ids': [380448], 'subject_names': ['ウマ娘 プリティーダービー ROAD TO THE TOP'], 'rates': [7], 'average_rate': 7.0}, {'person_name': '玉木慎吾', 'number': 1, 'subject_ids': [395714], 'subject_names': ['転生王女と天才令嬢の魔法革命'], 'rates': [5], 'average_rate': 5.0}, {'person_name': '河合滋樹', 'number': 1, 'subject_ids': [339326], 'subject_names': ['異世界おじさん'], 'rates': [7], 'average_rate': 7.0}, {'person_name': '井畑翔太', 'number': 1, 'subject_ids': [167434], 'subject_names': ['ガーリッシュ ナンバー'], 'rates': [6], 'average_rate': 6.0}, {'person_name': '追崎史敏', 'number': 1, 'subject_ids': [333664], 'subject_names': ['であいもん'], 'rates': [7], 'average_rate': 7.0}, {'person_name': '黒木美幸', 'number': 1, 'subject_ids': [331480], 'subject_names': ['明日ちゃんのセーラー服'], 'rates': [7], 'average_rate': 7.0}, {'person_name': '中山竜', 'number': 1, 'subject_ids': [321885], 'subject_names': ['チェンソーマン'], 'rates': [7], 'average_rate': 7.0}, {'person_name': '石浜真史', 'number': 1, 'subject_ids': [37785], 'subject_names': ['新世界より'], 'rates': [8], 'average_rate': 8.0}, {'person_name': '米田和弘', 'number': 1, 'subject_ids': [331445], 'subject_names': ['Do It Yourself!! -どぅー・いっと・ゆあせるふ-'], 'rates': [7], 'average_rate': 7.0}, {'person_name': '佐藤順一', 'number': 1, 'subject_ids': [531], 'subject_names': ['ARIA The ANIMATION'], 'rates': [7], 'average_rate': 7.0}, {'person_name': '伊藤祐毅', 'number': 1, 'subject_ids': [331535], 'subject_names': ['takt op.Destiny'], 'rates': [5], 'average_rate': 5.0}, {'person_name': '吉成曜', 'number': 1, 'subject_ids': [185792], 'subject_names': ['リトルウィッチアカデミア'], 'rates': [7], 'average_rate': 7.0}, {'person_name': '藤森雅也', 'number': 1, 'subject_ids': [184840], 'subject_names': ['終末のイゼ ッタ'], 'rates': [6], 'average_rate': 6.0}, {'person_name': '渡辺歩', 'number': 1, 'subject_ids': [326895], 'subject_names': ['サマータイムレンダ'], 'rates': [7], 'average_rate': 7.0}, {'person_name': '田中智也', 'number': 1, 'subject_ids': [375817], 'subject_names': ['Engage Kiss'], 'rates': [7], 'average_rate': 7.0}, {'person_name': '足立慎吾', 'number': 1, 'subject_ids': [364450], 'subject_names': ['リコリス・リコイル'], 'rates': [5], 'average_rate': 5.0}, {'person_name': '天衝', 'number': 1, 'subject_ids': [366793], 'subject_names': ['プリマドール'], 'rates': [5], 'average_rate': 5.0}, {'person_name': '中村隆太郎', 'number': 1, 'subject_ids': [2582], 'subject_names': ['Serial Experiments Lain'], 'rates': [0], 'average_rate': 0}, {'person_name': '石倉賢一', 'number': 1, 'subject_ids': [80838], 'subject_names': ['桜Trick'], 'rates': [7], 'average_rate': 7.0}, {'person_name': '橘正 紀', 'number': 1, 'subject_ids': [211936], 'subject_names': ['プリンセス・プリンシパル'], 'rates': [8], 'average_rate': 8.0}, {'person_name': '錦織敦史', 'number': 1, 'subject_ids': [11577], 'subject_names': ['THE IDOLM@STER'], 'rates': [7], 'average_rate': 7.0}, {'person_name': '博史池畠', 'number': 1, 'subject_ids': [121377], 'subject_names': ['それが声優！'], 'rates': [7], 'average_rate': 7.0}, {'person_name': 'イシグロキョウヘイ', 'number': 1, 'subject_ids': [273485], 'subject_names': ['サイダーのように言葉が湧き上がる'], 'rates': [5], 'average_rate': 5.0}, {'person_name': '川崎芳樹', 'number': 1, 'subject_ids': [326871], 'subject_names': ['処刑少女の生きる道'], 'rates': [7], 'average_rate': 7.0}, {'person_name': '山本寛', 'number': 1, 'subject_ids': [276], 'subject_names': ['らき☆すた'], 'rates': [8], 'average_rate': 8.0}, {'person_name': '武内宣之', 'number': 1, 'subject_ids': [200704], 'subject_names': ['打ち上げ花火、下から見るか ？横から見るか？'], 'rates': [6], 'average_rate': 6.0}, {'person_name': '押山清高', 'number': 1, 'subject_ids': [174584], 'subject_names': ['フリップフラッパーズ'], 'rates': [7], 'average_rate': 7.0}, {'person_name': '岡本英樹', 'number': 1, 'subject_ids': [145354], 'subject_names': ['マナリアフレンズ'], 'rates': [7], 'average_rate': 7.0}, {'person_name': '細田直人', 'number': 1, 'subject_ids': [50814], 'subject_names': ['はたらく魔王さま!'], 'rates': [7], 'average_rate': 7.0}, {'person_name': 'あおきえい', 'number': 1, 'subject_ids': [285776], 'subject_names': ['ID:INVADED イド：インヴェイデッド'], 'rates': [8], 'average_rate': 8.0}, {'person_name': '木下麦', 'number': 1, 'subject_ids': [325285], 'subject_names': ['オッドタクシー'], 'rates': [8], 'average_rate': 8.0}, {'person_name': '加藤誠', 'number': 1, 'subject_ids': [243981], 'subject_names': ['やがて君になる'], 'rates': [8], 'average_rate': 8.0}, {'person_name': '井端義秀', 'number': 1, 'subject_ids': [141781], 'subject_names': ['進撃！巨人中学校'], 'rates': [0], 'average_rate': 0}, {'person_name': '外崎春雄', 'number': 1, 'subject_ids': [245665], 'subject_names': ['鬼滅の刃'], 'rates': [6], 'average_rate': 6.0}, {'person_name': '川面真也', 'number': 1, 'subject_ids': [193378], 'subject_names': ['サクラダリセット'], 'rates': [8], 'average_rate': 8.0}, {'person_name': '柴田彰久', 'number': 1, 'subject_ids': [231497], 'subject_names': ['冴えない彼女の育てかた Fine'], 'rates': [8], 'average_rate': 8.0}, {'person_name': '尾崎隆晴', 'number': 1, 'subject_ids': [218707], 'subject_names': [' 少女終末旅行'], 'rates': [0], 'average_rate': 0}, {'person_name': '神戸守', 'number': 1, 'subject_ids': [243916], 'subject_names': ['約束のネバーランド'], 'rates': [8], 'average_rate': 8.0}, {'person_name': '柳伸亮', 'number': 1, 'subject_ids': [292527], 'subject_names': ['弱キャラ友崎くん'], 'rates': [6], 'average_rate': 6.0}, {'person_name': '江崎慎平', 'number': 1, 'subject_ids': [325286], 'subject_names': ["Vivy -Fluorite Eye's Song-"], 'rates': [8], 'average_rate': 8.0}, {'person_name': '大橋一輝', 'number': 1, 'subject_ids': [316957], 'subject_names': ['シャドーハウス'], 'rates': [6], 'average_rate': 6.0}, {'person_name': '赤城博昭', 'number': 1, 'subject_ids': [302190], 'subject_names': ['戦闘員、派遣します！'], 'rates': [6], 'average_rate': 6.0}, {'person_name': '高松信司', 'number': 1, 'subject_ids': [165829], 'subject_names': ['坂本ですが？'], 'rates': [0], 'average_rate': 0}, {'person_name': '迫井政行', 'number': 1, 'subject_ids': [266157], 'subject_names': ['慎重勇者 ～この勇者が俺TUEEEくせに慎重すぎる～'], 'rates': [6], 'average_rate': 6.0}, {'person_name': '鈴木健太郎', 'number': 1, 'subject_ids': [220566], 'subject_names': ['殺戮の天使'], 'rates': [0], 'average_rate': 0}, {'person_name': '橋本裕之', 'number': 1, 'subject_ids': [214272], 'subject_names': ['ようこそ実力至上主義の教室へ'], 'rates': [5], 'average_rate': 5.0}, {'person_name': '吉澤翠', 'number': 1, 'subject_ids': [159690], 'subject_names': ['マギアレコード 魔法少女まどか☆マギカ外伝'], 'rates': [0], 'average_rate': 0}, {'person_name': '岡田堅二朗', 'number': 1, 'subject_ids': [159690], 'subject_names': ['マギアレコード 魔法少女まどか☆マギカ外伝'], 'rates': [0], 'average_rate': 0}, {'person_name': '新房昭之', 'number': 1, 'subject_ids': [9717], 'subject_names': ['魔法少女まどか☆マギカ'], 'rates': [0], 'average_rate': 0}, {'person_name': '浜崎博嗣', 'number': 1, 'subject_ids': [10380], 'subject_names': ['STEINS;GATE'], 'rates': [9], 'average_rate': 9.0}, {'person_name': '小林智樹', 'number': 1, 'subject_ids': [10380], 'subject_names': ['STEINS;GATE'], 'rates': [9], 'average_rate': 9.0}, {'person_name': '若林漢二', 'number': 1, 'subject_ids': [23119], 'subject_names': ['STEINS;GATE 負荷領域のデジャヴ'], 'rates': [7], 'average_rate': 7.0}, {'person_name': '川口敬一郎', 'number': 1, 'subject_ids': [331033], 'subject_names': ['ひぐらしのなく頃に 卒'], 'rates': [5], 'average_rate': 5.0}, {'person_name': '川瀬敏文', 'number': 1, 'subject_ids': [1326], 'subject_names': ['ひぐらしのなく頃に礼'], 'rates': [7], 'average_rate': 7.0}, {'person_name': '高橋丈夫', 'number': 1, 'subject_ids': [198098], 'subject_names': ['citrus'], 'rates': [6], 'average_rate': 6.0}, {'person_name': '小林常夫', 'number': 1, 'subject_ids': [109053], 'subject_names': ['THE LAST -NARUTO THE MOVIE-'], 'rates': [0], 'average_rate': 0}, {'person_name': '小林治', 'number': 1, 'subject_ids': [2782], 'subject_names': ['NARUTO -ナルト- 疾風伝'], 'rates': [0], 'average_rate': 0}], 'invalid_subjects': [{'subject_id': 8019}], 'no_info_subjects': [{'subject_id': 503976, 'subject_name': '「真夜中ぱんチ」メンバーのソロ企画'}, {'subject_id': 7883, 'subject_name': 'それでも町は廻っている'}, {'subject_id': 443179, 'subject_name': 'Scavengers Reign'}, {'subject_id': 459283, 'subject_name': '葬送のフリーレン ～●●の魔法～'}, {'subject_id': 335036, 'subject_name': 'Arcane'}, {'subject_id': 274613, 'subject_name': 'Love, Death & Robots'}]})
    print('start fetching data')
    json_data = await request.json
    user_id = json_data.get('user_id')
    position = json_data.get('position')
    print(user_id, position)
    ranked_lists = await generate_ranked_lists(user_id, position)
    if ranked_lists:
        print('fetch data success!')
        return ranked_lists
    else:
        return jsonify({"error": "fail to fetch information"})

if __name__ == '__main__':
    asyncio.run(app.run())